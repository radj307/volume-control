<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Volume Control: Addon Development</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="iconSilvered.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Volume Control
   </div>
   <div id="projectbrief">Application-specific hotkeys for Windows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_docs__addon_development.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Addon Development </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Addons are written in C# with .NET Core 6 - you don't need any previous experience with C# in order to create addons, but this is not a tutorial for learning C#. <br  />
 <img src="https://i.imgur.com/DUI7k84.png" alt="" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md5"></a>
Volume Control SDK</h1>
<p>There are 2 methods for accessing the Volume Control SDK:</p><ul>
<li><b><a href="#using-nuget">Nuget</a></b> <br  />
 This is the preferred method, and is available from version <a href="https://github.com/radj307/volume-control/releases/5.2.0">5.2.0</a> onwards. <br  />
 See <a href="https://docs.microsoft.com/en-us/nuget/quickstart/install-and-use-a-package-in-visual-studio">here</a> for a guide on how to use Nuget in Visual Studio. <br  />
</li>
<li><b><a href="#manual-installation">Manual</a></b> <br  />
 You can also manually download the <code>SDK.zip</code> archive from the <a href="https://github.com/radj307/volume-control/releases">releases</a> page. <br  />
</li>
</ul>
<p>The installation steps for both methods can be found below. <br  />
</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Other Dependencies</h2>
<p><b>These are not required unless you want to use types/methods that depend on them.</b> <br  />
 In most cases, you won't need any of these; if you do need them, use Nuget to install them. <br  />
</p>
<ul>
<li><a href="https://github.com/naudio/NAudio">NAudio</a></li>
<li><a href="https://github.com/maxhauser/semver">Semver</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md7"></a>
What's in the SDK</h1>
<p>Each dependency from the Volume Control SDK has 3 files with different extensions and purposes. <br  />
</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Extension   </th><th class="markdownTableHeadNone">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>.dll</code>   </td><td class="markdownTableBodyNone">Contains the source code and references needed to use it.<br  />
This is the only mandatory dependency, the others are optional but recommended.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>.pdb</code>   </td><td class="markdownTableBodyNone">Contains debugging symbols, which allow you to use the debugger to step through code contained within the DLL.<br  />
<em>This must be located in the same directory as the associated DLL for it to work.</em>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>.xml</code>   </td><td class="markdownTableBodyNone">Contains the API documentation used by IDEs to provide documented intellisense.<br  />
This API documentation is also available <a href="https://radj307.github.io/volume-control/html/index.html">online</a>, but it's much easier to use when integrated.<br  />
<em>This must be located in the same directory as the associated DLL for it to work.</em>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md8"></a>
Environment Setup</h2>
<p>This assumes you're using Visual Studio with the **.NET/C#** workload installed. <br  />
</p>
<h3><a class="anchor" id="autotoc_md9"></a>
Using NuGet</h3>
<p><em>Available since <a href="https://github.com/radj307/volume-control/releases/5.2.0">v5.2.0</a></em></p>
<ol type="1">
<li>Create a new **.NET Core 6 Class Library** type solution, and name it whatever you want. <br  />
 <img src="https://user-images.githubusercontent.com/1927798/169677073-716d9c3b-5928-4414-8985-3dc22a79c160.png" alt="image" class="inline"/> <br  />
 <img src="https://user-images.githubusercontent.com/1927798/169677083-622c7461-11bb-4b57-8eeb-664ced0fde6f.png" alt="image" class="inline"/> <br  />
</li>
<li>R+Click on your <code>.csproj</code> file and click <b>Properties</b>. In the property pages, change the <b>Target OS</b> to <b>Windows</b>: <br  />
 <img src="https://user-images.githubusercontent.com/1927798/169683966-573f9c1c-4971-4304-a8b5-c01c931af5c2.png" alt="image" class="inline"/> <br  />
 Press <em>Ctrl+S</em> to save the project file, then close the tab.</li>
<li>In the solution explorer, R+Click on your project and select <b>Manage NuGet Packages for Project</b> <br  />
 <img src="https://i.imgur.com/oLeVqaM.png" alt="image" class="inline"/> <br  />
</li>
<li>Install the Volume Control SDK package. <br  />
 <img src="https://i.imgur.com/Zfka6S1.png" alt="image" class="inline"/> <br  />
</li>
</ol>
<h3><a class="anchor" id="autotoc_md10"></a>
Manual Installation</h3>
<ol type="1">
<li>Create a new **.NET Core 6 Class Library** type solution, and name it whatever you want. <br  />
 <img src="https://user-images.githubusercontent.com/1927798/169677073-716d9c3b-5928-4414-8985-3dc22a79c160.png" alt="image" class="inline"/> <br  />
 <img src="https://user-images.githubusercontent.com/1927798/169677083-622c7461-11bb-4b57-8eeb-664ced0fde6f.png" alt="image" class="inline"/> <br  />
</li>
<li>In the solution explorer, expand your new project and R+Click on the <b>Dependencies</b> entry, then select any of the <b>Add ... Reference</b> options. <br  />
 <img src="https://user-images.githubusercontent.com/1927798/169680877-f5a0b8dc-153b-46bd-b566-3e25c6af01b4.png" alt="image" class="inline"/></li>
<li>Click on the <b>Browse</b> tab &amp; add the DLLs from the sdk you downloaded earlier using the <b>Browse</b> button at the bottom. <br  />
 <img src="https://user-images.githubusercontent.com/1927798/169681046-b9b1d092-8500-42d7-a587-3f75a5f3698c.png" alt="image" class="inline"/> <br  />
 Once you're done, click <b>OK</b>.</li>
<li>R+Click on your <code>.csproj</code> file and click <b>Properties</b>. In the property pages, change the <b>Target OS</b> to <b>Windows</b>: <br  />
 <img src="https://user-images.githubusercontent.com/1927798/169683966-573f9c1c-4971-4304-a8b5-c01c931af5c2.png" alt="image" class="inline"/> <br  />
 Press <em>Ctrl+S</em> to save the project file, then close the tab.</li>
<li>You are now able to create custom addons for Volume Control. <br  />
 Add <code>using <a class="el" href="namespace_volume_control.html">VolumeControl</a>;</code> to the first line, and you'll be able to use Visual Studio's autocomplete for the rest.</li>
</ol>
<h2><a class="anchor" id="autotoc_md11"></a>
Writing an Addon</h2>
<p>Here's an example of an addon that adds a hotkey action named 'Custom Action' that writes a message to the log when triggered. <br  />
 </p><div class="fragment"><div class="line">using System.ComponentModel;</div>
<div class="line">//using VolumeControl.API; //&lt; until version 5.2.0</div>
<div class="line">using VolumeControl.SDK;   //&lt; since version 5.2.0</div>
<div class="line">using VolumeControl.Hotkeys.Attributes;</div>
<div class="line">using VolumeControl.Log;</div>
<div class="line"> </div>
<div class="line">namespace VolumeControl.TestAddon</div>
<div class="line">{</div>
<div class="line">    [ActionAddon(nameof(TestActionAddon))]</div>
<div class="line">    public class TestActionAddon</div>
<div class="line">    {</div>
<div class="line">        private static VCAPI API =&gt; VCAPI.Default;</div>
<div class="line">        private static LogWriter Log =&gt; VCAPI.Log;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        [HotkeyAction]</div>
<div class="line">        public void PrintSelected(object? sender, HandledEventArgs e)</div>
<div class="line">        {</div>
<div class="line">            Log.Debug($&quot;Successfully triggered addon method {nameof(CustomAction)}!&quot;,</div>
<div class="line">                      $&quot;Currently selected session name: &#39;{API.AudioAPI.SelectedSession?.ProcessName}&#39;&quot;);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        [HotkeyAction(&quot;My Action Name&quot;)]</div>
<div class="line">        public void CustomAction2(object? sender, Handled)</div>
<div class="line">        </div>
<div class="line">        </div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>You can find the full code example <a href="https://github.com/radj307/volume-control.TestAddon">here</a>.</p>
<p>See the <b><a href="https://github.com/radj307/volume-control/wiki/API-Documentation">API Documentation</a></b> for more information on what is available through the Volume Control SDK.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Building Your Addon</h2>
<p>Assuming you're using Visual Studio, you can use <b>Publish Profiles</b> to build your addon and place it in an easy-to-access directory. <br  />
</p>
<p>First, you'll need to create a new publish profile.</p>
<ol type="1">
<li>R+Click your addon project in the solution explorer, and select <b>Publish...</b> <br  />
 <img src="https://i.imgur.com/Ao5qYF0.png" alt="" class="inline"/></li>
<li>When asked to choose a target, select <b>Folder</b>. <br  />
 <img src="https://i.imgur.com/CYMEnam.png" alt="" class="inline"/></li>
<li>Choose an output directory; this should be a <b>relative</b> path that points somewhere within your solution directory / git repository. <br  />
 <img src="https://i.imgur.com/T3nt2Ga.png" alt="" class="inline"/> <br  />
</li>
<li>Do any additional configuration you want on your new publish profile. <br  />
 <img src="https://i.imgur.com/5Xzbvt1.png" alt="" class="inline"/> <br  />
</li>
<li>Click the <b>Publish</b> button to build your addon. <br  />
 The output files *(and only the output files)* can be found at the location you set in step 3. <br  />
 <img src="https://i.imgur.com/fbxy7VW.png" alt="" class="inline"/></li>
</ol>
<h2><a class="anchor" id="autotoc_md13"></a>
Loading Your Addon</h2>
<p>In order to see log messages related to the loading of addons, you need to enable the **<code>DEBUG</code>** log filter. <br  />
</p><ol type="1">
<li>Launch <code>VolumeControl.exe</code>, and navigate to the <b>Settings</b> tab. <br  />
</li>
<li>Find the <b>Filter</b> dropdown in the log settings area, and check the box next to **<code>DEBUG</code>** <br  />
</li>
</ol>
<h3><a class="anchor" id="autotoc_md14"></a>
Where to Put Addons</h3>
<p>Volume Control will attempt to load addons from a few locations, depending on the version. <br  />
 All versions of Volume Control will *(recursively)* load addons from <code>C:\Users\&lt;USERNAME&gt;\AppData\Local\radj307\Addons</code> first, if it exists. <br  />
 <b>Do not place Volume Control SDK dlls in addon directories, and do not include them when redistributing your addon.</b> <br  />
</p>
<p>Since <a href="https://github.com/radj307/volume-control/release/5.1.0">v5.1.0</a>, addons may also be located in any directories specified by the <code>CustomAddonDirectories</code> setting, which can be found in the configuration file: <br  />
 *(until <a href="https://github.com/radj307/volume-control/releases/5.2.0">v5.2.0</a>):* <code>~/AppData/Local/radj307/VolumeControl_Url_&lt;HASH&gt;/&lt;VERSION&gt;/user.config</code> <br  />
 *(since <a href="https://github.com/radj307/volume-control/releases/5.2.0">v5.2.0</a>):* <code>volumecontrol.json</code> located in the same directory as <code>VolumeControl.exe</code> <br  />
</p>
<p>Assuming you enabled <code>DEBUG</code> log messages, you will see messages in the log confirming that your addon was loaded when launching Volume Control: <br  />
 <img src="https://user-images.githubusercontent.com/1927798/169681684-f41649d3-49c0-4c33-aaf3-5454de4dfdad.png" alt="image" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md15"></a>
Using Your Addon</h2>
<p>In the case of action addons, they are used in the same way as the built-in actions: <br  />
</p>
<ol type="1">
<li>Enable <em>Edit Mode</em> on the <b>Settings</b> tab.</li>
<li>On the <b>Hotkeys</b> tab, open the dropdown box under the <em>Action</em> column of any hotkey.</li>
<li>Select your custom action in the list.</li>
</ol>
<p>Now, when you press the associated hotkey, your action method will be triggered! How you observe the outcome of that action depends on the action, of course; the action we created earlier for instance, does this: <br  />
 <img src="https://user-images.githubusercontent.com/1927798/184083946-959e3f2d-4b7b-4523-b597-0965d6145076.png" alt="custom-action-output" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md16"></a>
Redistributing Addons</h2>
<p>Once you've got your shiny new addon, you may want to distribute it to share your work. <br  />
 To encourage this, I've created an official repository for third-party addons <a href="https://github.com/radj307/volume-control.Addons">here</a>. <br  />
</p>
<blockquote class="doxtable">
<p>### Legal Because Volume Control is licensed under the <a href="https://github.com/radj307/volume-control/blob/main/LICENSE">GPLv3</a>, any code that uses the Volume Control SDK <b>must be licensed under the GPLv3 as well</b>; however <b>you are the sole owner</b> of the code that isn't from the SDK; assuming it isn't already licensed. <br  />
 </p>
</blockquote>
<h4><a class="anchor" id="autotoc_md17"></a>
Summary:</h4>
<ul>
<li>Make sure you use the <a href="https://github.com/radj307/volume-control/blob/main/LICENSE">GNU General Public License 3 (GPLv3)</a> license for your addon when uploading it to github or elsewhere. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
